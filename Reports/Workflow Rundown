# SOC Phishing Analysis Workflow

This workflow outlines the repeatable steps for analyzing suspicious or malicious emails.  
It simulates Tier 1 SOC analyst tasks, including email header review, IOC enrichment, and SOC-style incident reporting.

---

## 1. Collect the Email
- Obtain the full email, including **headers** and **body**.  
- Save as `.eml` or `.msg` if possible.  
-  Do not click any links or open attachments directly.  

---

## 2. Header Analysis
**Tools:**  
- [Google Message Header Analyzer](https://toolbox.googleapps.com/apps/messageheader/)  
- [MXToolbox Header Analyzer](https://mxtoolbox.com/EmailHeaders.aspx)  

**Check for:**  
- From vs. Reply-To mismatch  
- SPF / DKIM / DMARC results (pass or fail)  
- Source IP address and Received chain  

**Red Flags:**  
- Authentication failures (SPF/DKIM/DMARC all failing)  
- Suspicious domains or mismatched reply-to  

---

## 3. Domain & IP Reputation
**Tools:**  
- [VirusTotal](https://www.virustotal.com/)  
- [AbuseIPDB](https://www.abuseipdb.com/)  
- [Talos Intelligence](https://talosintelligence.com/reputation_center)  

**Steps:**  
- Look up sending domain in VirusTotal â†’ note results.  
- Check IP address reputation in AbuseIPDB and Talos.  
- Record results in your report.  

---

## 4. URL Analysis
**Tools:**  
- [URLScan.io](https://urlscan.io/)  
- [CheckPhish.ai](https://checkphish.ai/)  

**Steps:**  
- Paste suspicious URLs into URLScan.io.  
- Review redirects, screenshots, and domains contacted.  
- Save screenshot evidence.  

**Red Flags:**  
- Redirects to fake login pages (e.g., Microsoft/Google clones).  
- Recently registered domains.  
- Domains unrelated to the sender.  

---

## 5. Attachment Analysis
**Tools:**  
- Local hash calculation:  
  - Windows: `Get-FileHash filename` (PowerShell)  
  - Linux: `sha256sum filename`  
- [VirusTotal File Upload](https://www.virustotal.com/)  
- [Hybrid Analysis](https://www.hybrid-analysis.com/) or [Any.Run](https://any.run/)  

**Steps:**  
- Calculate SHA256 hash of attachment.  
- Upload hash or file to VirusTotal.  
- If safe, test in sandbox (Hybrid Analysis or Any.Run).  
- Record hash and results in IOCs list.  

**Red Flags:**  
- Executables (`.exe`, `.scr`, `.bat`)  
- Scripts (`.vbs`, `.js`, `.ps1`)  
- Registry files (`.reg`) that modify system settings  

---

## 6. Classification
Decide what the email is:  
- **Phishing:** Credential harvest attempt (fake login page, reply-to mismatch)  
- **Malware Delivery:** Attachment designed to infect host  
- **BEC (Business Email Compromise):** Impersonation, financial fraud  
- **Spam:** Low threat, nuisance only  

Assign a **Risk Level:** Low, Medium, High.  

---

## 7. Document Findings
Use the case report template to record:  
- Metadata (From, Reply-To, SPF/DKIM/DMARC, IPs)  
- IOCs (URLs, hashes, IPs, domains)  
- Screenshots of analysis tools  
- Conclusion (why malicious, what classification)  
- Recommended actions  

---

## 8. Store Evidence
- Place **case report** in `reports/` (e.g., `PHISH-2025-001.md`).  
- Place **screenshots** in `screenshots/phish-001/`.  
- Place **IOC list** in `iocs/phish-001-iocs.txt`.  

---

## 9. Recommended Actions
Typical remediation steps:  
- Block sender domain and reply-to addresses.  
- Blacklist URLs and file hashes in SIEM/endpoint tools.  
- Alert end-users to phishing attempt.  
- Add rules/detections for similar IOCs.  

---

## 10. Repeat
Apply this workflow for each phishing email sample to build a consistent set of case reports.  
Over time, this demonstrates your ability to handle phishing investigations in a SOC environment.  

---
